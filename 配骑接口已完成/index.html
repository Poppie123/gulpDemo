<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
     <!-- 视图窗口，移动端特属的标签。 -->
     <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no" />
     <!-- 是否启动webapp功能，会删除默认的苹果工具栏和菜单栏。 user-scalable=no"用户可扩展否 -->
     <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>首页</title>
    <link rel="stylesheet" href="../../css/cleardefault.css">
    <link rel="stylesheet" href="../../css/normalize.css">
    <link rel="stylesheet" href="../../css/swiper.css">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/iconfont.css">
    <link rel="stylesheet" href="../../css/hui.css">
    <style>
       #hui-load-more{
           top: -1.08rem;
       }
    
    </style>
</head>
<body class="body-bac">
    <div class="top">
        <div class="search link-to" data-href="./index-search.html">
            <i class="iconfont iconsousuo"></i>
            <span>请输入商品名称</span> 
        </div>
    </div>
    <div class="top88"></div>
    <div id="refreshContainer" class="hui-refresh">
            <div class="hui-refresh-icon"></div>
        <div class="banner">
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    
                </div>
                <!-- 如果需要分页器 -->
                <div class="swiper-pagination"></div> 
            </div>
        </div>
        <div class="index-classify">
            <div class="list link-to" data-href="./index-hot.html">
                <img src="../../images/hot@2x.png" alt="">
                <div>热卖商品</div>
            </div>
            <div class="list link-to" data-href="./index-news.html">
                <img src="../../images/news@2x.png" alt="">
                <div>新品上市</div>
            </div>
            <div class="list link-to" data-href="./index-sale.html">
                <img src="../../images/sale@2x.png" alt="">
                <div>今日促销</div>
            </div>
            <div class="list link-to" data-href="./index-temai.html">
                <img src="../../images/temai@2x.png" alt="">
                <div>特卖商品</div>
            </div>
        </div>
        <div class="index-list">
            <div class="l-top">
                <div class="font32-w">热卖商品</div>
                <div class="font24-9 link-to" data-href="./index-hot.html">
                    <span>更多</span>
                    <i class="iconfont icongengduo"></i>
                </div>
            </div>
            <ul class="list hot-list">
                <!-- <li class="list-img">
                    <img src="../../images/maojin@2x.png" alt="">
                    <div class="ellipse">纯白毛巾大小尺纯白毛巾大小尺</div>
                    <div class="mt">
                        <span class="price">¥15.41</span> 
                        <span class="price-del">¥20.00</span>
                    </div>
                </li> -->
                
            </ul> 
        </div>
        <div class="index-list">
            <div class="l-top sale">
                <div class="font32-w">促销商品</div>
                <div class="font24-9 link-to" data-href="./index-sale.html">
                    <span>更多</span>
                    <i class="iconfont icongengduo"></i>
                </div>
            </div>
            <ul class="list sale-list">    
            </ul>  
        </div>
        <div class="index-list">
            <div class="l-top news">
                <div class="font32-w">新品上市</div>
                <div class="font24-9 link-to" data-href="./index-news.html">
                    <span>更多</span>
                    <i class="iconfont icongengduo"></i>
                </div>
            </div>
            <ul class="list new-list">
                
            </ul>  
        </div>
        <img class="reco-img" src="../../images/perfect@2x.png" alt="">
        <ul class="recommond recommend-list">
            <!-- <li class="list-img">
                <img src="./images/bed@2x.png" alt="">
                <div class="ml-11">
                    <div class="ellipse">五星级酒店专用床上用品五星级酒店专用床上用品</div>
                    <div  class="mt">
                        <span class="price">¥655.00</span>
                        <span class="price-del">¥2000.00</span>
                    </div>
                </div>
            </li> -->
        </ul>
    </div>
   
    <div class="bottom108"></div>
    <div class="bottom">
        <div class="list">
            <img src="../../images/index@2x.png" alt="">
            <div class="active">首页</div>
        </div>
        <div class="list">
            <img src="../../images/classify@2x(2).png" alt="">
            <div>分类</div>
        </div>
        <div class="list">
            <img src="../../images/car@2x(1).png" alt="">
            <div>购物车</div>
        </div>
        <div class="list">
            <img src="../../images/mine@2x.png" alt="">
            <div>我的</div>
        </div>
    </div>
    <script src="../../js/swiper.js"></script>
    <script src="../../js/jquery-3.3.1.min.js"></script>
    <script src="../../js/hui.js"></script>
    <script src="../../js/hui-refresh-load-more.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/common.js"></script>
    <script>        
        var mySwiper = new Swiper ('.swiper-container', {
            loop: true, // 循环模式选项
            autoplay:{
                stopOnLastSlide:true,
                delay: 3000,
            },
            // 如果需要分页器
            pagination: {
            el: '.swiper-pagination',
            },      
        })        
    </script>
    <script>
        $(document).ready(function(){
            var totalCount;
            var isload = 1;
            //init()
            /* 下拉刷新 */
            hui.refresh('#refreshContainer', init);
            /* 上拉加载 */
            hui.loadMore(getTopGds);
            function init(){
                //if(hui.refreshNumber < 1){hui.loading('加载中...');}
                hui.loading('加载中')
                setTimeout(function(){
                    getBanner()
                    getHotGds()
                    getLowGds()
                    getNewGds()
                    getTopGds()
                },2000)
            }
            /* 上拉加载更多 */
            /* function getMore() {
                hui.get(
                    'http://hoa.hcoder.net/index.php?user=hcoder&pwd=hcoder&m=list1&page=' + page,
                    function (res) {
                        //判断加载完毕
                        if (res == 'null') {
                            hui.endLoadMore(true, '已经到头了...');
                            return false;
                        }
                        var data = res.split('--hcSplitor--');
                        for (var i = 0; i < data.length; i++) {
                            var li = document.createElement('li');
                            li.innerHTML = '<div class="hui-list-text">' + data[i] + '</div>';
                            hui(li).appendTo('#list');
                        }
                        page++;
                        hui.endLoadMore();
                    }
                );
            } */
            //获取轮播图
            function getBanner(){
                reqAjax('/api/app/get_banner', {}, function (res) {
                    if (res.code == 1) {
                        var dt = res.data || [];
                        var html = "";
                        dt.map(function (v) {
                            html += '<div class="swiper-slide"><img src="' + v.banner + '"></div>'
                        });
                        $('.swiper-wrapper').html(html);
                        var swiper = new Swiper('.swiper-container', {
                            loop: true,
                            pagination: {
                                el: '.swiper-pagination',
                            },
                            autoplay: {
                                delay: 5000, //5秒切换一次
                                disableOnInteraction: false,
                            },
                        })
                    }
                });
            }
            /* 获取热卖商品信息 */
            function getHotGds(){
                reqAjax('/api/goods/search_hot', {price_order:1,start:0}, function (res) {
                    if (res.code == 1) {
                        var dt = res.data || [];
                        var html = "";
                        dt.map(function (v) {
                            html += '<li class="list-img"><img src="' + v.pic + '"><div class="ellipse">' 
                                +v.goods_name+'</div><div class="mt"><span class="price">¥' +v.shop_price 
                                +'</span><span class="price-del">¥'+v.market_price+'</span></div></li>'
                        });
                        $('.hot-list').html(html);
                    }
                });
            }
            /* 获取促销商品信息 */
            function getLowGds(){
                reqAjax('/api/goods/get_low_goods', { price_order: 1, start: 0 }, function (res) {
                    if (res.code == 1) {
                        var dt = res.data || [];
                        var html = "";
                        dt.map(function (v) {
                            html += '<li class="list-img"><img src="' + v.pic + '"><div class="ellipse">'
                                + v.goods_name + '</div><div class="mt"><span class="price">¥' + v.shop_price
                                + '</span><span class="price-del">¥' + v.market_price + '</span></div></li>'
                        });
                        $('.sale-list').html(html);
                    }
                });
            }
            /* 获取新品商品信息 */
            function getNewGds(){
                reqAjax('/api/goods/search_new', { price_order: 1, start: 0 }, function (res) {
                    if (res.code == 1) {
                        var dt = res.data || [];
                        var html = "";
                        dt.map(function (v) {
                            html += '<li class="list-img"><img src="' + v.pic + '"><div class="ellipse">'
                                + v.goods_name + '</div><div class="mt"><span class="price">¥' + v.shop_price
                                + '</span><span class="price-del">¥' + v.market_price + '</span></div></li>'
                        });
                        $('.new-list').html(html);
                    }
                });
            }
            /* 获取精品推荐商品信息 */
            function getTopGds(){
                if (isload !=1) {
                    return false
                }
                var start = $('.recommond .list-img').length
                console.log(start)
                reqAjax('/api/goods/get_top_goods', { start: start }, function (res) {
                    hui.endRefresh();
                    if (res.code == 1) {
                        var dt = res.data || [];
                        var html = "";
                        dt.map(function (v) {
                            html += '<li class="list-img"><img class="hui-lazy" lazySrc="'+v.img+'" src="../../images/lazy.png"><div class="ml-11"><div class="ellipse">'
                                + v.goods_name + '</div><div class="mt"><span class="price">¥' + v.shop_price
                                + '</span><span class="price-del">¥' + v.market_price + '</span></div></div></li>'
                        });
                        $('.recommond').append(html);
                        hui.lazyLoad();
                        if ($('.recommond .list-img').length == res.count) {
                            isload = 0;
                            hui.endLoadMore(true)
                        }
                    }
                    
                });
            }
        });   
    </script>
</body>
</html>