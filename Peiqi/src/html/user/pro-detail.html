<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
  <!-- 视图窗口，移动端特属的标签。 -->
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no" />
  <!-- 是否启动webapp功能，会删除默认的苹果工具栏和菜单栏。 user-scalable=no"用户可扩展否 -->
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>订单-详情页</title>
    <link rel="stylesheet" href="../../css/cleardefault.css">
    <link rel="stylesheet" href="../../css/normalize.css">
    <link rel="stylesheet" href="../../css/swiper.css">
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../../css/iconfont.css">
    <link rel="stylesheet" href="../../css/hui.css">
    <style>
        .swiper-container{
            width: 100%;
            height: 7.5rem;
        }
    
    
    </style>
</head>
<body class="body-bac">
    <div class="product-top">
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <div class="swiper-slide"><img src="../../images/pro-main@2x.png" alt=""></div>
                <div class="swiper-slide"><img src="../../images/pro-main@2x.png" alt=""></div>
                <div class="swiper-slide"><img src="../../images/pro-main@2x.png" alt=""></div>
            </div>
            <!-- 如果需要分页器 -->
            <div class="swiper-pagination"></div>
        </div>
        <div class="back">
            <i class="iconfont iconiconfontjiantou1"></i>
        </div>
    </div>
    <div class="product-detail">
        <div class="wrapper">
            <div class="price"><span>￥<span id="shop_price">2560</span></span></div>
            <div class="price-del"><span>￥<span id="market_price">3600</span></span></div>
            <div class="p-detail" id="goods_name">五星级酒店专用床上四件套 包含两个大枕头 一个 抱枕 强烈推荐</div>
            <div class="p-info">
                <div><span>已售：<span>2535</span></span></div>
                <div><span>库存：<span>2535</span></span></div>
                <div><span>运费：<span>0</span></span></div>
            </div>
        </div>
    </div>
    <img class="renz" src="./images/renzheng@2x.png" alt="">
    <div class="product-select">
        <div id="select-guige" class="list">
            <span class="font24-9">选择规格</span>
            <div>
                <span class="font28-3">套餐一</span>
                <i class="iconfont iconyoujiantou"></i>
            </div>
        </div>
        <div class="list">
            <span class="font24-9">数量</span>
            <div class="account">
                <span class="font28-9">-</span>
                <div class="p-sum">1</div>
                <span>+</span>
            </div>
        </div>
    </div>
    <div class="product-assess">
        <div class="list-one">
            <div class="pingjia">
                <span class="font28-3">商品评价</span>
                <span class="font28-9">(<span>4526<span></span>人评价</span>)</span>
            </div>
            <i id="pingjia" class="iconfont iconyoujiantou"></i>
        </div>
        <div class="person">
            <div>
                <img src="./images/touxiang@2x.png" alt="">
                <span>爱丽丝</span>
            </div>
            <div class="xing">
                <i class="iconfont iconstar active"></i>
                <i class="iconfont iconstar active"></i>
                <i class="iconfont iconstar active"></i>
                <i class="iconfont iconstar active"></i>
                <i class="iconfont iconstar"></i>
                <span class="font28-9c"><span>4.6</span>分</span>
            </div>
        </div>
        <div class="p-time">
            <span>2019-05-22</span>&ensp;<span>16:22</span>
        </div>
        <div class="p-word">
            检查过了是正品,质量超好，很开心的一次网购。第一次用这个平台，没想价格便宜，东西又好，还会再来
        </div>
        <div class="pic-list">
            <img src="./images/pro-l@2x.png" alt="">
            <img src="./images/pro-l@2x.png" alt="">     
            <img src="./images/pro-l@2x.png" alt="">
        </div>
    </div>
    <div class="product-de">
        <div class="xq">商品详情</div>
        <div id="goods_detial">

        </div>
    </div>
    <div class="bottom108"></div>
    <div class="product-bottom">
        <div class="list-btn">
            <div class="btn1">
                <i class="iconfont icongouwuche1"></i>
                <div>购物车</div>
            </div>
            <div class="btn1">
                <i class="iconfont iconkefu"></i>
                <div>客服</div>
            </div>
            <div class="btn1 " id="shoucang">
                <i class="iconfont iconziyuan"></i>
                <div>收藏</div>
            </div>
        </div>
        <div class="list-btn none">
            <span>合计金额:<span class="font36-f5">￥<span>2560</span></span></span>
        </div>
        <div class="cart-btn">加入购物车</div>
        <div class="buy-btn">立即购买</div>
    </div>
    <!-- 规格弹窗 -->
    <div class="product-shadow none"></div>
    <div class="product-popup none">
        <div class="product-detail pop-detail">
            <img src="./images/pro-main@2x.png" alt="">
            <div class="list">
                <div class="p-detail ellipse">五星级酒店专用四件套 纯棉五星级酒店专用四件套 纯棉</div>
                <div class="price">￥2560</div>
                <div class="price-del">￥3600</div>
            </div>
        </div>
        <div class="font28-9">规格</div>
        <div class="product-guige">
            <div class="option active">套餐一</div>
            <div class="option">套餐二</div>
            <div class="option">套餐三</div>
            <div class="option">套餐四</div>
        </div>
        <div class="product-num">
            <span class="font28-9">数量</span>
            <div class="account">
                <span class="font28-9">-</span>
                <div class="p-sum">1</div>
                <span>+</span>
            </div>
        </div>
    </div>
    <script src="../../js/swiper.js"></script>
    <script src="../../js/jquery-3.3.1.min.js"></script>
    <script src="../../js/hui.js"></script>
    <script src="../../js/common.js"></script>
    <script>        
             
    </script>
    <script>
        $(document).ready(function(){
            var id = getQueryString('id')
            console.log(id);
            getGoodsDetail()
            getGoodsIsCollect()
            function getGoodsDetail(){
                reqAjax('/api/goods/get_goods_detail',{id:id,start:0},function(res){
                    if (res.code == 1) {
                        // 替换banner图
                        var bannnerList = res.data.goods_imgs || [];
                        var bannerStr = "";
                        bannnerList.map(function(v){
                              bannerStr+= '<div class="swiper-slide"><img src="'+v.img+'" alt=""></div>'
                        }) 
                        $('.swiper-wrapper').html(bannerStr);
                        var mySwiper = new Swiper ('.swiper-container', {
                            loop: true, // 循环模式选项
                            autoplay:{
                                stopOnLastSlide:true,
                                delay: 3000,
                            },
                            // 如果需要分页器
                            pagination: {
                            el: '.swiper-pagination',
                            },      
                        })  
                        $('#shop_price').html(res.data.shop_price);
                        $('#market_price').html(res.data.market_price);
                        $('#goods_name').html(res.data.goods_name)
                        $('#goods_detial').html(res.data.detail)
                    } 
                })
            }
            function getGoodsIsCollect(){
                if (!isLogin()) {
                   return false 
                }
                reqAjax('/api/goods/is_collect',{goods_id:id},function(res){
                    if (res.code == 1) {
                        $('#shoucang').addClass('active')
                    }else{
                        $('#shoucang').removeClass('active')
                    }
                })
            }
            $('#shoucang').click(function(){
                if (!isLogin()) {
                   return false 
                }
                reqAjax('/api/goods/goods_collect',{goods_id:id},function(){})
                $('#shoucang').toggleClass('active')
                /* reqAjax('/api/goods/goods_collect',{},function(res){
                    if(res.code==1){
                        hui.toast(res.msg);
                        $('#shoucang').addClass('active');
                    }
                }); */
                // $.ajax({
                //     url: '/api/goods/goods_collect',
                //     method: 'post',
                //     success: function (res) {
                //     // reqAjax('/api/goods/goods_collect', { }, function (res) {
                //         /* if (res.code == 1) {
                //             hui.toast(res.msg);
                //             console.log(res.msg);
                //             $('#shoucang').addClass('active');
                //         } */
                        
                //         if($('#shoucang').hasClass('active')){ //当点击收藏，再点击取消？？
                //             $('#shoucang').removeClass('active');
                //             console.log(res.msg);
                //             hui.toast(res.msg);
                //         }
                //         else if(res.msg="商品收藏成功"){
                //             hui.toast(res.msg);
                //             console.log(res.msg);
                //             $('#shoucang').addClass('active');
                //         }
                //         else{
                //             hui.toast('尚未登录，请先登录');
                //             setTimeout(function () {
                //                 window.location.href= "../user/login.html"
                //             }, 2000)
                //         }
                        
                //     },
                //     err: function (err) {
                //     }
                // })
            });
            $('.back').click(function(){
                history.go(-1);
            });
            $('.option').click(function(){
                $('.option').removeClass('active');
                $(this).addClass('active');
            });
            $('#select-guige').click(function(){
                $('.product-shadow').removeClass('none');
                $('.product-popup').removeClass('none');
                $('.list-btn').first().addClass('none');
                $('.list-btn').last().removeClass('none');
            });
            $('.product-shadow').click(function(){
                $(this).addClass('none');
                $('.product-popup').addClass('none');
                $('.list-btn').first().removeClass('none');
                $('.list-btn').last().addClass('none');
            });
            $('.list-one').click(function(){
                window.location.href='./pro-detail-pingjia.html';
            });
        });
        
    </script>
</body>
</html>